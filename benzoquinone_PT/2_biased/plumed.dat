#! vim:ft=plumed

# input file for biased intramolecular double proton transfer in 2,5-diamino-1,4-benzoquinone with Deep-TDA

# we can use the coordination numbero of the havy atoms!
# we would like to preserve the symmetries

#UNITS
UNITS LENGTH=A

# ==== GROUPS ====
C: GROUP ATOMS=1,2,3,4,5,6
N: GROUP ATOMS=9,12
O: GROUP ATOMS=15,16
H: GROUP ATOMS=7,8,10,11,13,14

# ==== HEAVY ATOMS ====
C1: GROUP ATOMS=1
C2: GROUP ATOMS=2
C3: GROUP ATOMS=3
C4: GROUP ATOMS=4
C5: GROUP ATOMS=5
C6: GROUP ATOMS=6
N1: GROUP ATOMS=9
N2: GROUP ATOMS=12
O1: GROUP ATOMS=15
O2: GROUP ATOMS=16

c1c: COORDINATION GROUPA=C1 GROUPB=C SWITCH={RATIONAL D_0=0.0 R_0=1.7 NN=6 MM=8} NOPBC
c1n: COORDINATION GROUPA=C1 GROUPB=N SWITCH={RATIONAL D_0=0.0 R_0=1.7 NN=6 MM=8} NOPBC
c1o: COORDINATION GROUPA=C1 GROUPB=O SWITCH={RATIONAL D_0=0.0 R_0=1.6 NN=6 MM=8} NOPBC
c1h: COORDINATION GROUPA=C1 GROUPB=H SWITCH={RATIONAL D_0=0.0 R_0=1.2 NN=6 MM=8} NOPBC
c2c: COORDINATION GROUPA=C2 GROUPB=C SWITCH={RATIONAL D_0=0.0 R_0=1.7 NN=6 MM=8} NOPBC
c2n: COORDINATION GROUPA=C2 GROUPB=N SWITCH={RATIONAL D_0=0.0 R_0=1.7 NN=6 MM=8} NOPBC
c2o: COORDINATION GROUPA=C2 GROUPB=O SWITCH={RATIONAL D_0=0.0 R_0=1.6 NN=6 MM=8} NOPBC
c2h: COORDINATION GROUPA=C2 GROUPB=H SWITCH={RATIONAL D_0=0.0 R_0=1.2 NN=6 MM=8} NOPBC
c3c: COORDINATION GROUPA=C3 GROUPB=C SWITCH={RATIONAL D_0=0.0 R_0=1.7 NN=6 MM=8} NOPBC
c3n: COORDINATION GROUPA=C3 GROUPB=N SWITCH={RATIONAL D_0=0.0 R_0=1.7 NN=6 MM=8} NOPBC
c3o: COORDINATION GROUPA=C3 GROUPB=O SWITCH={RATIONAL D_0=0.0 R_0=1.6 NN=6 MM=8} NOPBC
c3h: COORDINATION GROUPA=C3 GROUPB=H SWITCH={RATIONAL D_0=0.0 R_0=1.2 NN=6 MM=8} NOPBC
c4c: COORDINATION GROUPA=C4 GROUPB=C SWITCH={RATIONAL D_0=0.0 R_0=1.7 NN=6 MM=8} NOPBC
c4n: COORDINATION GROUPA=C4 GROUPB=N SWITCH={RATIONAL D_0=0.0 R_0=1.7 NN=6 MM=8} NOPBC
c4o: COORDINATION GROUPA=C4 GROUPB=O SWITCH={RATIONAL D_0=0.0 R_0=1.6 NN=6 MM=8} NOPBC
c4h: COORDINATION GROUPA=C4 GROUPB=H SWITCH={RATIONAL D_0=0.0 R_0=1.2 NN=6 MM=8} NOPBC
c5c: COORDINATION GROUPA=C5 GROUPB=C SWITCH={RATIONAL D_0=0.0 R_0=1.7 NN=6 MM=8} NOPBC
c5n: COORDINATION GROUPA=C5 GROUPB=N SWITCH={RATIONAL D_0=0.0 R_0=1.7 NN=6 MM=8} NOPBC
c5o: COORDINATION GROUPA=C5 GROUPB=O SWITCH={RATIONAL D_0=0.0 R_0=1.6 NN=6 MM=8} NOPBC
c5h: COORDINATION GROUPA=C5 GROUPB=H SWITCH={RATIONAL D_0=0.0 R_0=1.2 NN=6 MM=8} NOPBC
c6c: COORDINATION GROUPA=C6 GROUPB=C SWITCH={RATIONAL D_0=0.0 R_0=1.7 NN=6 MM=8} NOPBC
c6n: COORDINATION GROUPA=C6 GROUPB=N SWITCH={RATIONAL D_0=0.0 R_0=1.7 NN=6 MM=8} NOPBC
c6o: COORDINATION GROUPA=C6 GROUPB=O SWITCH={RATIONAL D_0=0.0 R_0=1.6 NN=6 MM=8} NOPBC
c6h: COORDINATION GROUPA=C6 GROUPB=H SWITCH={RATIONAL D_0=0.0 R_0=1.2 NN=6 MM=8} NOPBC

n1h: COORDINATION GROUPA=N1 GROUPB=H SWITCH={RATIONAL D_0=0.0 R_0=1.1 NN=6 MM=8} NOPBC
n2h: COORDINATION GROUPA=N2 GROUPB=H SWITCH={RATIONAL D_0=0.0 R_0=1.1 NN=6 MM=8} NOPBC

o1h: COORDINATION GROUPA=O1 GROUPB=H SWITCH={RATIONAL D_0=0.0 R_0=1.2 NN=6 MM=8} NOPBC
o2h: COORDINATION GROUPA=O2 GROUPB=H SWITCH={RATIONAL D_0=0.0 R_0=1.2 NN=6 MM=8} NOPBC

# ==== PYTORCH MODEL ====
nncv: PYTORCH_MODEL MODEL=../deepTDA_benzo.pt ARG=n1h,n2h,o1h,o2h,c1c,c1n,c1o,c1h,c2c,c2n,c2o,c2h,c3c,c3n,c3o,c3h,c4c,c4n,c4o,c4h,c5c,c5n,c5o,c5h,c6c,c6n,c6o,c6h

# ==== LIMIT CV ====
lwall_nncv: LOWER_WALLS ARG=nncv.node-0 AT=-16 KAPPA=400
uwall_nncv: UPPER_WALLS ARG=nncv.node-0 AT=+16 KAPPA=400

# ==== OPES PARAMETERS ====
opes: OPES_METAD ...
        ARG=nncv.node-0
        PACE=500
        BARRIER=120
        SIGMA=0.20
        TEMP=300
...

# ==== PRINT STUFF ====
PRINT FILE=colvar ARG=nncv.node-0,opes.*,n1h,n2h,o1h,o2h,lwall_nncv.*,uwall_nncv.* STRIDE=500

